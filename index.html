<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Truck Weight Helper</title>
  <script src="telegram-auth.js"></script> <!-- –Ω–∞—à JS —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π -->
</head>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –¥–æ—Å—Ç—É–ø –∫ Telegram WebApp API
    if (window.Telegram?.WebApp) {
      const tg = window.Telegram.WebApp;
      tg.expand(); // –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω (–¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞)

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      const user = tg.initDataUnsafe?.user;

      if (user && user.username) {
        // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
        document.body.innerHTML = `
          <div style="text-align:center; margin-top:50px; font-family:sans-serif;">
            <h2>‚úÖ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, @${user.username}!</h2>
            <p>ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ${user.id}</p>
          </div>
        `;
        console.log("–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:", user);
      } else {
        // –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ –Ω–µ –∏–∑ Telegram)
        document.body.innerHTML = `
          <div style="text-align:center; margin-top:50px; font-family:sans-serif;">
            <h2>‚ùå –û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram</h2>
            <p>Telegram –Ω–µ –ø–µ—Ä–µ–¥–∞–ª –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.</p>
          </div>
        `;
        console.warn("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö Telegram WebApp. –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Å–∞–π—Ç –æ—Ç–∫—Ä—ã—Ç –∏–∑ Telegram.");
      }
    } else {
      // Telegram API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
      document.body.innerHTML = `
        <div style="text-align:center; margin-top:50px; font-family:sans-serif;">
          <h2>‚ùå Telegram WebApp API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω</h2>
          <p>–û—Ç–∫—Ä–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—É —á–µ—Ä–µ–∑ Telegram Mini App.</p>
        </div>
      `;
      console.error("Telegram WebApp API –Ω–µ –Ω–∞–π–¥–µ–Ω.");
    }
  });
</script>
<body>
  <div id="app">
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
  </div>
</body>
</html>
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Truck Weight Helper</title>
  <style>
    :root {
      --primary: #0088cc;
      --primary-light: #00aaff;
      --bg: #f8f9fa;
      --text: #222;
      --card-bg: #fff;
      --border: #ccc;
      font-family: "Inter", system-ui, sans-serif;
    }

    body {
      margin: 0;
      padding: 20px;
      background: var(--bg);
      color: var(--text);
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
    }

    h1 {
      text-align: center;
      color: var(--primary);
      margin-bottom: 20px;
    }

    .language-select {
      position: fixed;
      top: 10px;
      right: 10px;
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 5px 10px;
      cursor: pointer;
    }

    form {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    label {
      font-weight: 500;
    }

    input {
      padding: 10px;
      border-radius: 8px;
      border: 1px solid var(--border);
      font-size: 1rem;
      width: 100%;
    }

    button {
      padding: 12px;
      background: var(--primary);
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      font-size: 1rem;
    }

    button:hover {
      background: var(--primary-light);
    }

    .result {
      margin-top: 20px;
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 16px;
      display: none;
    }

    .result h2 {
      margin-top: 0;
      color: var(--primary);
      font-size: 1.2rem;
    }

    .row {
      display: flex;
      justify-content: space-between;
      margin: 6px 0;
    }

    .note {
      text-align: center;
      color: #555;
      margin-top: 12px;
      font-size: 0.9rem;
    }

    .alert {
      margin-top: 10px;
      padding: 10px;
      background: #ffe9e9;
      color: #a00;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <div class="language-select">
    <select id="langSelect">
      <option value="ru" selected>RU</option>
      <option value="en">EN</option>
    </select>
  </div>

  <h1 id="title">–ü–æ–º–æ—â–Ω–∏–∫ –ø–æ –≤–µ—Å—É —Ç—Ä–∞–∫–∞</h1>

  <form id="weightForm">
    <label id="labelTruck">–í–µ—Å —Ç—è–≥–∞—á–∞ (lbs):</label>
    <input type="number" id="truckWeight" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä 18000" min="0" required>

    <label id="labelTrailer">–í–µ—Å –ø—É—Å—Ç–æ–≥–æ —Ç—Ä–µ–π–ª–µ—Ä–∞ (lbs):</label>
    <input type="number" id="trailerWeight" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä 12000" min="0" required>

    <label id="labelCargo">–í–µ—Å –≥—Ä—É–∑–∞ (lbs):</label>
    <input type="number" id="cargoWeight" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä 40000" min="0" required>

    <label id="labelFuel">–¢–æ–ø–ª–∏–≤–æ (–≥–∞–ª–ª–æ–Ω—ã):</label>
    <input type="number" id="fuelGallons" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä 100" min="0" required>

    <button type="submit" id="calcButton">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
  </form>

  <div id="result" class="result"></div>

  <div class="note" id="note">–°–¥–µ–ª–∞–Ω–æ –¥–ª—è Telegram Mini App üöö</div>

  <script>
    const translations = {
      ru: {
        title: "–ü–æ–º–æ—â–Ω–∏–∫ –ø–æ –≤–µ—Å—É —Ç—Ä–∞–∫–∞",
        labelTruck: "–í–µ—Å —Ç—è–≥–∞—á–∞ (lbs):",
        labelTrailer: "–í–µ—Å –ø—É—Å—Ç–æ–≥–æ —Ç—Ä–µ–π–ª–µ—Ä–∞ (lbs):",
        labelCargo: "–í–µ—Å –≥—Ä—É–∑–∞ (lbs):",
        labelFuel: "–¢–æ–ø–ª–∏–≤–æ (–≥–∞–ª–ª–æ–Ω—ã):",
        calcButton: "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å",
        totalWeight: "–û–±—â–∏–π –≤–µ—Å",
        steerAxle: "–ü–µ—Ä–µ–¥–Ω—è—è –æ—Å—å",
        driveAxle: "–í–µ–¥—É—â–∏–µ –æ—Å–∏",
        trailerAxle: "–û—Å–∏ —Ç—Ä–µ–π–ª–µ—Ä–∞",
        fuelWeight: "–í–µ—Å —Ç–æ–ø–ª–∏–≤–∞",
        fuelRemaining: "–û—Å—Ç–∞—Ç–æ–∫ —Ç–æ–ø–ª–∏–≤–∞ (–≥–∞–ª–ª–æ–Ω—ã)",
        alertSteer: "‚ö†Ô∏è –ü–µ—Ä–µ–¥–Ω—è—è –æ—Å—å –ø—Ä–µ–≤—ã—à–µ–Ω–∞",
        alertDrive: "‚ö†Ô∏è –í–µ–¥—É—â–∏–µ –æ—Å–∏ –ø—Ä–µ–≤—ã—à–µ–Ω—ã",
        alertTrailer: "‚ö†Ô∏è –û—Å–∏ —Ç—Ä–µ–π–ª–µ—Ä–∞ –ø—Ä–µ–≤—ã—à–µ–Ω—ã",
        holeMsgForward: "–°–¥–≤–∏–Ω—å—Ç–µ —Ç—Ä–µ–π–ª–µ—Ä –≤–ø–µ—Ä—ë–¥ {holes} –¥—ã—Ä–∫–∏(–æ–∫)",
        holeMsgBack: "–°–¥–≤–∏–Ω—å—Ç–µ —Ç—Ä–µ–π–ª–µ—Ä –Ω–∞–∑–∞–¥ {holes} –¥—ã—Ä–∫–∏(–æ–∫)",
        balanced: "–í–µ—Å –ø–æ –æ—Å—è–º –≤ –Ω–æ—Ä–º–µ ‚úÖ",
        note: "–°–¥–µ–ª–∞–Ω–æ –¥–ª—è Telegram Mini App üöö"
      },
      en: {
        title: "Truck Weight Assistant",
        labelTruck: "Truck Weight (lbs):",
        labelTrailer: "Trailer Empty Weight (lbs):",
        labelCargo: "Cargo Weight (lbs):",
        labelFuel: "Fuel (gallons):",
        calcButton: "Calculate",
        totalWeight: "Total Weight",
        steerAxle: "Steer Axle",
        driveAxle: "Drive Axle",
        trailerAxle: "Trailer Axle",
        fuelWeight: "Fuel Weight",
        fuelRemaining: "Fuel Remaining (gallons)",
        alertSteer: "‚ö†Ô∏è Steer axle over limit",
        alertDrive: "‚ö†Ô∏è Drive axle over limit",
        alertTrailer: "‚ö†Ô∏è Trailer axle over limit",
        holeMsgForward: "Move trailer forward {holes} hole(s)",
        holeMsgBack: "Move trailer back {holes} hole(s)",
        balanced: "Axle weights look balanced ‚úÖ",
        note: "Made for Telegram Mini App üöö"
      }
    };

    const FUEL_WEIGHT_PER_GAL = 6.2;
    const MAX_STEER = 12000;
    const MAX_DRIVE = 34000;
    const MAX_TRAILER = 34000;
    const MAX_TOTAL = 80000;
    const WEIGHT_PER_HOLE = 250;

    const form = document.getElementById('weightForm');
    const resultDiv = document.getElementById('result');
    const langSelect = document.getElementById('langSelect');

    function updateLanguage(lang) {
      const t = translations[lang];
      document.getElementById('title').textContent = t.title;
      document.getElementById('labelTruck').textContent = t.labelTruck;
      document.getElementById('labelTrailer').textContent = t.labelTrailer;
      document.getElementById('labelCargo').textContent = t.labelCargo;
      document.getElementById('labelFuel').textContent = t.labelFuel;
      document.getElementById('calcButton').textContent = t.calcButton;
      document.getElementById('note').textContent = t.note;
    }

    langSelect.addEventListener('change', () => updateLanguage(langSelect.value));
    updateLanguage('ru');

    form.addEventListener('submit', (e) => {
      e.preventDefault();

      const truckWeight = Math.max(0, parseFloat(document.getElementById('truckWeight').value) || 0);
      const trailerWeight = Math.max(0, parseFloat(document.getElementById('trailerWeight').value) || 0);
      const cargoWeight = Math.max(0, parseFloat(document.getElementById('cargoWeight').value) || 0);
      const fuelGallons = Math.max(0, parseFloat(document.getElementById('fuelGallons').value) || 0);

      const fuelWeight = fuelGallons * FUEL_WEIGHT_PER_GAL;
      const totalWeight = truckWeight + trailerWeight + cargoWeight + fuelWeight;

      // –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Å–∞
      let steer = 0.15 * totalWeight;
      let drive = 0.425 * totalWeight;
      let trailer = 0.425 * totalWeight;

      const t = translations[langSelect.value];

      let alertMsg = '';
      if (steer > MAX_STEER) alertMsg += `${t.alertSteer} (${steer.toFixed(0)} / ${MAX_STEER})<br>`;
      if (drive > MAX_DRIVE) alertMsg += `${t.alertDrive} (${drive.toFixed(0)} / ${MAX_DRIVE})<br>`;
      if (trailer > MAX_TRAILER) alertMsg += `${t.alertTrailer} (${trailer.toFixed(0)} / ${MAX_TRAILER})<br>`;
      if (totalWeight > MAX_TOTAL) alertMsg += `‚ö†Ô∏è ${t.totalWeight} –ø—Ä–µ–≤—ã—à–µ–Ω (${totalWeight.toFixed(0)} / ${MAX_TOTAL})<br>`;

      // –ü–æ–¥—Å–∫–∞–∑–∫–∞ –ø–æ "–¥—ã—Ä–∫–∞–º"
      let holeMsg = '';
      if (drive > MAX_DRIVE && trailer < MAX_TRAILER) {
        const diff = drive - MAX_DRIVE;
        const moveHoles = Math.ceil(diff / WEIGHT_PER_HOLE);
        holeMsg = t.holeMsgBack.replace("{holes}", moveHoles);
      } else if (trailer > MAX_TRAILER && drive < MAX_DRIVE) {
        const diff = trailer - MAX_TRAILER;
        const moveHoles = Math.ceil(diff / WEIGHT_PER_HOLE);
        holeMsg = t.holeMsgForward.replace("{holes}", moveHoles);
      } else {
        holeMsg = t.balanced;
      }

      // –°–∫–æ–ª—å–∫–æ —Ç–æ–ø–ª–∏–≤–∞ –º–æ–∂–Ω–æ –µ—â—ë –¥–æ–ª–∏—Ç—å
      const remainingWeight = Math.max(0, MAX_TOTAL - totalWeight);
      const remainingGallons = Math.floor(remainingWeight / FUEL_WEIGHT_PER_GAL);

      resultDiv.style.display = 'block';
      resultDiv.innerHTML = `
        <h2>${t.totalWeight} & –†–∞—Å—á—ë—Ç</h2>
        <div class="row"><span>${t.totalWeight}:</span><b>${totalWeight.toFixed(0)} lbs</b></div>
        <div class="row"><span>${t.steerAxle}:</span><b>${steer.toFixed(0)} / ${MAX_STEER}</b></div>
        <div class="row"><span>${t.driveAxle}:</span><b>${drive.toFixed(0)} / ${MAX_DRIVE}</b></div>
        <div class="row"><span>${t.trailerAxle}:</span><b>${trailer.toFixed(0)} / ${MAX_TRAILER}</b></div>
        <div class="row"><span>${t.fuelWeight}:</span><b>${fuelWeight.toFixed(0)} lbs</b></div>
        <div class="row"><span>${t.fuelRemaining}:</span><b>${remainingGallons}</b></div>
        <div class="note">${holeMsg}</div>
        ${alertMsg ? `<div class="alert">${alertMsg}</div>` : ''}
      `;

    });

    // Telegram Mini App support
    if (window.Telegram && window.Telegram.WebApp) {
      const tg = window.Telegram.WebApp;
      tg.ready();
      if (tg.colorScheme === 'dark') {
        document.body.style.background = '#1e1e1e';
        document.body.style.color = '#eee';
      }
    }
  </script>
</body>
</html>
